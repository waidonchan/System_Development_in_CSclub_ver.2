## ✅ 主な機能

- Google フォーム送信時に自動で処理を分岐（個人 or 団体）
- 回答内容に基づいて**スコア・責任者・確認クイズの条件分岐**
- 合格者にはテンプレートドキュメントを元に自動生成 & Slack 通知
- Slack スタンプによる承認 / 却下ワークフローの連携
- 不合格者には自動メール送信（理由ごとに内容が変化）
- Google ドライブに画像付きドキュメントを保存
- スプレッドシートの行背景色変更（合格：緑、不合格：グレー）

---

## 🛠 構成

- `onFormSubmit(e)`: フォーム送信時のエントリーポイント
- `handleIndividualSubmission(e)`: 個人申請の分岐ロジック
- `handleClubSubmission(e)`: 団体申請の分岐ロジック
- `executeIndividualOriginalProcess() / executeClubOriginalProcess()`: 合格者への通知・ドキュメント生成処理
- `generate[Individual|Club]RejectionMessage()`: 条件別メールテンプレート生成
- `sendSlackNotification()`: Slack への通知を送信（別スクリプトと連携）
- `sendMail()`: メール送信
- `getProps()`: スクリプトプロパティ管理

---

## 🔧 環境変数（Script Properties）

以下のキーを [Apps Script のスクリプトプロパティ] に設定してください：

| Key                     | 説明                                                                |
| ----------------------- | ------------------------------------------------------------------- |
| `TEMPLATE_DOC_ID`       | Google ドキュメントのテンプレート ID                                |
| `DESTINATION_FOLDER_ID` | 生成されたドキュメントを保存するフォルダの ID                       |
| `WEBHOOK_URL`           | Slack 通知を送る外部 Web アプリ（リアクション判定スクリプト）の URL |
| `ADMINISTRATOR_EMAIL`   | 管理者のメールアドレス（CC に使用）                                 |

---

## 📥 導入方法

1. Google フォームに紐づいた Google スプレッドシートを作成
2. Apps Script を開き、本スクリプトを貼り付け
3. 環境変数を設定（Script Properties）
4. `onFormSubmit` をトリガーとして設定
5. Slack アプリ側のスタンプ処理用スクリプト（別途）と連携

---

## 🧪 条件分岐例

| スコア       | 衛生責任者 | クイズ           | 処理                       |
| ------------ | ---------- | ---------------- | -------------------------- |
| 満点 (33 点) | はい       | 空欄             | 合格                       |
| 満点         | はい       | 「読みました。」 | 不合格（クイズミス）       |
| 満点         | いいえ     | 任意             | 不合格（資格なし）         |
| 不満点       | はい       | 任意             | 不合格（スコア不足）       |
| 不満点       | いいえ     | 任意             | 不合格（スコア＆資格不足） |

---

## 📦 注意事項

- Slack 通知は別スクリプト（リアクション処理・リマインド処理）との連携が必要です。
- DriveApp の使用にはスコープの許可が必要です。
- 申請に関する個人情報を扱うため、取り扱いには十分注意してください。
